<div class = "flex-grow flex items-start justify-start pt-55">
<div class="max-w-xl mx-auto mt-10 p-6 bg-white rounded-lg shadow-md">
  <h1 class="text-2xl font-bold mb-4">Калькулятор векторов и матриц</h1>

  <%= form_with url: vector_calculate_path,
                method: :post,
                local: true,
                data: { turbo: false },
                html: { class: 'space-y-6' } do |f| %> <!-- с turbo не разобрался -->

    <div>
      <%= f.label :operation,
                  'Что посчитать?',
                  class: 'block text-sm font-medium text-gray-700' %>

      <%= f.select :operation,
                   options_for_select([
                                        ['Детерминант', 'determinant'],
                                        ['Скалярное произведение', 'dot'],
                                        ['Векторное произведение', 'cross']
                                      ], params[:operation] || 'determinant'),
                   {},    # пустой options-хэш
                   class: %(
                 mt-1
                 block
                 w-full
                 border
                 border-gray-300
                 bg-white
                 rounded-md
                 px-1 py-2
                 shadow-sm
                 focus:outline-none
                 focus:ring-2
                 focus:ring-gray-500
               ).squish,
                   prompt: false %>
    </div>


    <!-- Блок для ввода матрицы -->
    <div id="matrix-fields" class="<%= (params[:operation] || 'determinant') == 'determinant' ? '' : 'hidden' %>">
      <%= f.label :matrix, "Введите матрицу:", class: 'block text-sm font-medium text-gray-700' %>
      <%= f.text_area :matrix,
                      value: params[:matrix],
                      placeholder: "1   2   3\n4   5   6\n7   8   9",
                      rows: 3,
                      class: 'mt-1 block w-full border border-gray-300 rounded-md p-2 focus:border-blue-500 focus:ring-blue-500' %>
    </div>

    <!-- Блок для ввода векторов -->
    <div id="vector-fields" class="<%= (params[:operation] || 'determinant') == 'determinant' ? 'hidden' : '' %> space-y-4">
      <div>
        <%= f.label :vector1, 'Вектор 1', class: 'block text-sm font-medium text-gray-700' %>
        <%= f.text_field :vector1, placeholder: '1 2 3', class: 'mt-1 block w-full rounded-md border border-gray-300', value: params[:vector1] %>
      </div>
      <div>
        <%= f.label :vector2, 'Вектор 2', class: 'block text-sm font-medium text-gray-700' %>
        <%= f.text_field :vector2, placeholder: '4 5 6', class: 'mt-1 block w-full rounded-md border border-gray-300', value: params[:vector2] %>
      </div>
    </div>

    <div class="flex space-x-4">
      <%= f.submit 'Рассчитать', class: 'px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:ring' %>
      <%= link_to 'Сбросить', root_path, class: 'px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 focus:ring' %>
    </div>
  <% end %>

  <% if @result.present? %>
    <div class="mt-6 p-4 bg-green-50 border border-green-200 rounded-md">
      <h2 class="text-xl font-semibold text-green-800">Результат</h2>
      <p class="mt-2 text-lg text-gray-900"><%= @result %></p>
    </div>
  <% end %>

  <script>
      document.addEventListener('DOMContentLoaded', () => {
          const op = document.querySelector('select[name="operation"]')
          const mf = document.getElementById('matrix-fields')
          const vf = document.getElementById('vector-fields')

          op.addEventListener('change', () => {
              if (op.value === 'determinant') {
                  mf.classList.remove('hidden')
                  vf.classList.add('hidden')
              } else {
                  vf.classList.remove('hidden')
                  mf.classList.add('hidden')
              }
          })
      })
  </script>
</div>
</div>